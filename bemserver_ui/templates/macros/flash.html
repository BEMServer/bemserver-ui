{% set FLASH_MESSAGE_DATA = {
    "message": {
        "css": "primary",
        "icon": "chat-text",
    },
    "info": {
        "css": "info",
        "icon": "info-square",
    },
    "warning": {
        "css": "warning",
        "icon": "exclamation-triangle",
    },
    "error": {
        "css": "danger",
        "icon": "x-octagon",
    },
    "success": {
        "css": "success",
        "icon": "check-circle",
    },
} %}

{% macro display_messages() %}
    {% for category, message in get_flashed_messages(with_categories=True) %}
        <div class="alert alert-{{ FLASH_MESSAGE_DATA[category]['css'] }} alert-dismissible fade show" role="alert">
            <i class="bi bi-{{ FLASH_MESSAGE_DATA[category]['icon'] }} me-2"></i>
            {{ message|safe }}
            {% set validation_errors = session.pop("_validation_errors", {}) %}
            {% if validation_errors|length > 0 %}
            <p class="mt-3 mb-0">Validation errors</p>
            <dl class="row ms-2">
                {% for field_name, field_errors in validation_errors.items() %}
                <dt class="col-2">{{ field_name }}</dt>
                <dd class="col-10{% if loop.last %} mb-0{% endif %}">
                    {% for field_error in field_errors %}
                    <p class="fst-italic mb-0">{{ field_error }}</p>
                    {% endfor %}
                </dd>
                {% endfor %}
            </dl>
            {% endif %}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    {% endfor %}
{% endmacro %}